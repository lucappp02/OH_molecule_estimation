function y = SNRgs(B, E, t)
h = 1.055e-34;
delta = 2*pi*1.667*10^9;
Kb = 1.38e-23;

me = 1.66 *3.336e-30;
mb = 9.274e-24;

DBH=  diag([-6/5, -2/5, 2/5, 6/5, -6/5, -2/5, 2/5, 6/5]);

DExH= [0,0,0,0, 3/5, 0, 0,0;
    0, 0,0,0, 0, 1/5, 0, 0;
    0,0,0, 0 ,0, 0, -1/5, 0;
    0,0,0,0, 0,0,0, -3/5;
    3/5, 0, 0,0,0,0,0,0;
   0, 1/5,0, 0, 0,0, 0, 0;
    0, 0, -1/5, 0, 0, 0,0, 0;
    0, 0, 0, -3/5, 0, 0,0, 0];


 DEyH=  [0,0,0,0,0, -sqrt(3)/5, 0,0;
    0, 0,0,0, -sqrt(3)/5, 0, -2/5, 0;
    0,0,0, 0 ,0, -2/5, 0, -sqrt(3)/5;
    0,0,0,0, 0,0, -sqrt(3)/5, 0;
    0, -sqrt(3)/5, 0,0,0,0,0,0;
    -sqrt(3)/5, 0,-2/5, 0, 0,0, 0, 0;
    0, -2/5, 0, -sqrt(3)/5, 0, 0,0, 0;
    0, 0, -sqrt(3)/5, 0, 0, 0,0, 0];

DH(:,:,1) = DBH;
DH(:,:,2) = DExH;
DH(:,:,3) = DEyH;


[V,D] = eig(hamOH(B, E, t));
[d,ind] = sort(diag(D));
V = V(:,ind);

Q = zeros(3,3);

for m= 1:3
    for n = 1:3
        for k = 2:8
            Q(m,n) = Q(m,n)+ (1/(d(1)-d(k))^2)*(ctranspose(V(:,1))*DH(:,:,m)*V(:,k)).*(ctranspose(V(:,k))*DH(:,:,n)*V(:,1));
        end
    end
end

invQ = 1/4*Q^(-1);
W = diag([1/(mb*B/Kb)^2,1/(me*E*cos(t)/Kb)^2,1/(me*E*sin(t)/Kb)^2]);

 y = 1/trace(invQ*W);

end